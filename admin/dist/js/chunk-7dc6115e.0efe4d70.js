(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dc6115e"],{"34a8":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{key:t.$route.meta.title,staticClass:"v2-search"},[i("Form",{ref:"formKey",attrs:{model:t.formKey,rules:t.rules}},[i("div",{staticClass:"mb20"},[i("FormItem",[i("span",{staticClass:"ml10"},[t._v("活动类型")]),i("Select",{staticClass:"w110x ml20",model:{value:t.formKey.activity_type,callback:function(e){t.$set(t.formKey,"activity_type",e)},expression:"formKey.activity_type"}},[i("Option",{attrs:{value:"normal_activity"}},[t._v("常规活动")]),i("Option",{attrs:{value:"url_activity"}},[t._v("链接活动")])],1)],1)],1),i("div",{staticClass:"mb25"},[i("FormItem",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"活动标题",prop:"title"}},[i("Input",{staticClass:"w609x ml5",attrs:{placeholder:"请输入标题(20字以内)"},model:{value:t.formKey.title,callback:function(e){t.$set(t.formKey,"title",e)},expression:"formKey.title"}})],1)],1),i("div",{staticClass:"mb20"},[i("FormItem",{attrs:{label:"活动时间",prop:"activity_date_type"}},[i("Select",{staticClass:"w110x ml5",model:{value:t.formKey.activity_date_type,callback:function(e){t.$set(t.formKey,"activity_date_type",e)},expression:"formKey.activity_date_type"}},[i("Option",{attrs:{value:"lasting"}},[t._v("永久上架")]),i("Option",{attrs:{value:"custom"}},[t._v("自定义时间")])],1)],1)],1),"custom"==t.formKey.activity_date_type?i("div",{staticClass:"clearfix mb20",attrs:{label:"起止时间"}},[i("FormItem",{staticClass:"fl",attrs:{label:"开始日期",prop:"online_time"}},[i("DatePicker",{staticClass:"w165x ml5",attrs:{type:"datetime",placeholder:"请选择日期",size:"large",format:"yyyy-MM-dd HH:mm"},model:{value:t.formKey.online_time,callback:function(e){t.$set(t.formKey,"online_time",e)},expression:"formKey.online_time"}})],1),i("FormItem",{staticClass:"fl ml5",attrs:{label:"结束日期",prop:"offline_time"}},[i("DatePicker",{staticClass:"w165x",attrs:{type:"datetime",placeholder:"请选择日期",size:"large",format:"yyyy-MM-dd HH:mm"},model:{value:t.formKey.offline_time,callback:function(e){t.$set(t.formKey,"offline_time",e)},expression:"formKey.offline_time"}})],1)],1):t._e(),i("div",[i("FormItem",{attrs:{label:"活动分类",prop:"activity_cate_name"}},[i("Select",{staticClass:"w160x ml5",model:{value:t.formKey.activity_cate_id,callback:function(e){t.$set(t.formKey,"activity_cate_id",e)},expression:"formKey.activity_cate_id"}},t._l(t.actlist,function(e){return i("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.activity_cate_name))])}),1)],1)],1),i("div",{staticClass:"mb20"},[i("FormItem",[i("span",{staticClass:"ml40"},[t._v("状态")]),i("i-switch",{staticClass:"ml20",attrs:{size:"large"},model:{value:t.formKey.status,callback:function(e){t.$set(t.formKey,"status",e)},expression:"formKey.status"}}),i("span",{staticClass:"ml5"},[t._v(t._s(!0===t.formKey.status?"已启用":"未启用"))])],1)],1),i("div",{staticClass:"mb20"},[i("FormItem",{attrs:{label:"发布平台",prop:"client_type"}},[i("CheckboxGroup",{staticClass:"ml5",model:{value:t.formKey.client_type,callback:function(e){t.$set(t.formKey,"client_type",e)},expression:"formKey.client_type"}},[i("Checkbox",{attrs:{label:"pc"}},[i("span",[t._v("PC")])]),i("Checkbox",{attrs:{label:"mobile"}},[i("span",[t._v("移动端")])])],1)],1)],1),i("FormItem",{staticClass:"pic",attrs:{label:"标题图片",prop:"image"}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[t._v(t._s(t.formKey.image))]),i("div",{staticClass:"mb mb20 ml10",style:t.formKey.client_type.length<2?{textAlign:"center"}:{}},[i("p",{staticClass:"font",staticStyle:{"text-align":"left"}},[t._v("尺寸限制：PC-750x280px 移动端-750x280px")]),i("div",{staticClass:"upload-img"},t._l(t.uploadList,function(e,n){return i("UpLoads",t._b({key:n,attrs:{editPic:"edit"===t.$route.params.page?t.formKey.image:{}},on:{"on-success":t.uploadSuccess,"on-format-error":t.handleFormatError}},"UpLoads",e,!1))}),1)])]),"normal_activity"==t.formKey.activity_type?i("div",[i("div",{staticClass:"mb mt20 ml10"},[i("span",{staticClass:"ml0",attrs:{prop:"desc_type"}},[t._v("编辑内容")]),i("div",{staticClass:"v2-button ml5"},[i("Button",{staticClass:"w148x fl mt10 ml10",class:1==this.seltext?"active":"",on:{click:t.onText}},[t._v("文本")]),i("Button",{staticClass:"w148x fl mt10",class:1==this.selimg?"active":"",on:{click:t.onImg}},[t._v("使用图片")])],1),t.selimg?i("div",{staticClass:"upload-img edit-img",style:t.formKey.client_type.length<2?{textAlign:"center"}:{}},t._l(t.uploadList,function(e,n){return i("UpLoads",t._b({key:n,attrs:{useType:"edit",editPic:"edit"===t.$route.params.page&&"pic"===t.formKey.desc_type?t.formKey.description:{}},on:{"on-success":t.uploadSuccess,"on-format-error":t.handleFormatError}},"UpLoads",e,!1))}),1):t._e()]),t.seltext?i("div",{key:"txt",staticClass:"ml10  mb20 add-acitivity"},t._l(t.formKey.client_type,function(e){return i("div",{key:e},[i("span",[t._v(t._s("pc"===e?"PC端":"移动端"))]),i("UE",{ref:"pc"===e?t.ue1:t.ue2,refInFor:!0,staticClass:"editor",class:"pc"===e?"pc-editor":"",attrs:{defaultMsg:"pc"===e?t.defaultMsg1:t.defaultMsg2,config:t.config,id:"pc"===e?t.ue1:t.ue2}})],1)}),0):t._e()]):t._e(),"url_activity"==t.formKey.activity_type?i("div",[i("FormItem",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"文件地址",prop:"url_link"}},[i("Input",{staticClass:"w609x ml5",attrs:{placeholder:"请输入标题文件地址"},model:{value:t.formKey.url_link,callback:function(e){t.$set(t.formKey,"url_link",e)},expression:"formKey.url_link"}})],1)],1):t._e()],1),i("Button",{staticClass:"ivu-btn addSave ml80",on:{click:t.submit}},[t._v(t._s("edit"===t.$route.params.page?"确认保存":"确认新增"))]),i("Modal",{attrs:{title:"图片预览","class-name":"vertical-center-modal"}})],1)},a=[],o=(i("28a5"),i("7618")),s=i("f499"),r=i.n(s),c=(i("6762"),i("2fdb"),i("a4bb")),l=i.n(c),u=i("cebc"),m=(i("ac6a"),i("a0f0")),d=i("e945"),f=i("8593"),p=(i("2934"),i("c276")),y=(i("2f62"),i("3e8f"),i("3c43"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[t.pic?i("div",{key:t.pic,staticClass:"content-img"},[i("img",{staticClass:"img",attrs:{src:t.pic,alt:""}})]):t._e(),i("div",{staticClass:"content-body"},[i("Upload",{attrs:{action:t.action,multiple:t.multiple,type:t.type,headers:t.headers,data:t.data,name:t.name,format:t.format,"max-size":t.maxSize,"show-upload-list":t.showUploadList,"default-file-list":t.defaultFileList,"before-upload":t.handleUpload,"on-success":t.handleSuccess,"on-error":t.handleError,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize}},[i("div",{staticClass:"content-title"},[i("Icons",{attrs:{type:"zhongduan-"+("pc"===t.showType?"PC":"shouji"),size:"19",color:"#C5C5C5"}}),i("span",{staticClass:"title-txt"},[t._v(t._s(t.imgType))])],1),i("p",{staticClass:"content-txt"},[t._v("鼠标拖拽图片至此区域以上传")]),t.pic?i("Button",{key:"reUpload",staticClass:"btn",attrs:{icon:"ios-cloud-upload-outline"}},[t._v("重新上传")]):i("Button",{key:"upload",attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传文件")])],1)],1)])}),h=[],_=(i("c5f6"),i("83ae")),v={name:"uploads",components:{Icons:_["a"]},props:{useType:{type:String,default:""},showType:{type:String,required:!0},action:{type:String,required:!0},multiple:{type:Boolean,default:!1},type:{type:String,default:"drag"},headers:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{}}},name:{type:String,default:"img"},format:{type:Array,default:function(){return["jpg","jpeg","png"]}},maxSize:{type:Number,default:2048},showUploadList:{type:Boolean,default:!1},editPic:{type:Object,default:function(){return{}}}},data:function(){return{defaultFileList:[{}],pic:""}},watch:{showType:function(){this.pic=""}},computed:{imgType:function(){return"pc"===this.showType?"PC端":"移动端"}},methods:{handleUpload:function(){},handleSuccess:function(t){200===t.code&&(this.pic="".concat(t.data.host,"/").concat(t.data.src),this.$emit("on-success",t,this.showType,this.useType))},handleError:function(t){},handleFormatError:function(t){this.$emit("on-format-error",t,useType)},handleMaxSize:function(){}},created:function(){var t=this;this.$nextTick(function(){t.editPic[t.showType]&&(t.pic=t.editPic[t.showType])})}},g=v,b=(i("db16"),i("2877")),K=Object(b["a"])(g,y,h,!1,null,"479d4f27",null),x=K.exports,C=(i("5118"),{name:"addActivities",components:{Editor:m["a"],UpLoads:x,UE:d["a"]},data:function(){var t=function(t,e,i){void 0===e.pc&&void 0===e.mobile?i(new Error("请选择标题图片")):i()};return{serchKey:{siteId:this.$root.nowSite.id,adminId:this.$store.state.user.userInfo.adminId,adminName:this.$store.state.user.userInfo.userName},actlist:[],rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],activity_date_type:[{required:!0,trigger:"change",message:"请选择活动时间",pattern:/.+/}],client_type:[{required:!0,message:"请选择客户端",trigger:"change",pattern:/.+/}],online_time:[{required:!0,message:"请选择开始日期",trigger:"change",pattern:/.+/}],offline_time:[{required:!0,message:"请选择结束日期",trigger:"change",pattern:/.+/}],activity_type:[{required:!0,message:"请选择活动类型",pattern:/.+/,trigger:"change"}],image:[{type:"object",required:!0,validator:t,trigger:"change"}],url_link:[{required:!0,message:"请输入文件链接",trigger:"blur"}]},uploadList:[],uploadForm:{headers:{Authorization:Object(p["j"])()},action:"/api/v2/uploadImg",data:{siteId:this.$root.nowSite.id},name:"img"},defaultMsg1:"",defaultMsg2:"",config:{initialFrameWidth:900,initialFrameHeight:350},ue1:"ue1",ue2:"ue2",showPcImg:!1,showMoImg:!1,seltext:!0,selimg:!1,type:!1,visible:!1,content:"",pc:!0,h5:!1,formKey:{title:"",status:!0,activity_type:"normal_activity",activity_date_type:"custom",activity_cate_id:"",online_time:"",offline_time:"",client_type:[],image:{},desc_type:"",description:{},url_link:""}}},watch:{"formKey.client_type":{handler:function(t){var e=this;this.uploadList=[],t.forEach(function(t){e.uploadList.push(Object(u["a"])({},e.uploadForm,{showType:t}))}),l()(this.formKey.image).forEach(function(i){t.includes(i)||delete e.formKey.image[i]}),l()(this.formKey.description).forEach(function(i){t.includes(i)||"value"===i||delete e.formKey.description[i]})},deep:!0},"formKey.activity_type":function(){}},created:function(){this.getActivelist()},methods:{handleFormatError:function(t){this.$Tip.info({content:"请上传图片"})},uploadSuccess:function(t,e,i){200===t.code&&("edit"===i?this.formKey.description[e]=t.data.path:this.formKey.image[e]=t.data.path)},handleView:function(t){},onText:function(){this.seltext=!0,this.selimg=!1,this.formKey.desc_type="text"},onImg:function(){this.selimg=!0,this.seltext=!1,this.formKey.desc_type="pic",this.formKey.description={}},submit:function(){var t=this;this.$refs.formKey.validate(function(e){if(e){var i=Object(u["a"])({},t.formKey,t.serchKey);l()(i).forEach(function(e){"client_type"===e?i["client_type"]=t.formKey["client_type"].join(","):"status"===e?i["status"]=!0===t.formKey["status"]?"yes":"no":"image"===e?i[e]=r()(t.formKey.image):"activity_date_type"===e?"lasting"===t.formKey[e]?(delete i.online_time,delete i.offline_time):(i.online_time=t.$root.formatTimeS(i.online_time),i.offline_time=t.$root.formatTimeS(i.offline_time)):"activity_type"===e&&("normal_activity"===i[e]?(t.seltext?(t.formKey.client_type.map(function(e){i.description[e]="pc"===e?t.$refs.ue1[0].getUEContent():t.$refs.ue2[0].getUEContent()}),i.description=r()(i.description),i.desc_type="text"):t.selimg&&(i.description=r()(t.formKey.description),i.desc_type="pic"),delete i.url_link):"url_activity"===i[e]&&(delete i.description,delete i.desc_type))}),"edit"===t.$route.params.page?Object(f["j"])(i).then(function(e){try{200===e.code&&(t.resetForm(t.formKey),t.$store.commit("closeTag",t.$route),setTimeout(function(){t.$Tip.hide()},1e3),t.$router.push({name:"activeList"}))}catch(i){}}):Object(f["h"])(i).then(function(e){try{200===e.code&&(t.resetForm(t.formKey),t.$store.commit("closeTag",t.$route),setTimeout(function(){t.$Tip.hide()},1e3),t.$router.push({name:"activeList"}))}catch(i){}})}})},resetForm:function(t){var e=function(e){"object"===Object(o["a"])(t[e])?t[e]instanceof Array?t[e]=[]:"description"===e?l()(t[e]).map(function(i){"value"!==i?delete t[e][i]:t[e][i]=" "}):t[e]={}:t[e]="status"!==e&&""};for(var i in t)e(i)},getActivelist:function(){var t=this;Object(f["d"])({siteId:this.$root.nowSite.id}).then(function(e){t.actlist=e.data})},initEdit:function(t){var e=this;l()(this.formKey).forEach(function(i){"client_type"===i?t[i]&&(e.formKey[i]=t[i].split(",")):"image"===i?t[i]&&(e.formKey[i]=JSON.parse(t["imageShow"])):"status"===i?e.formKey[i]="yes"===t[i]:"online_time"===i?t[i]&&(e.formKey.online_time=e.$root.unixTime(t[i])):"offline_time"===i?t[i]&&(e.formKey.offline_time=e.$root.unixTime(t[i])):e.formKey[i]=t[i]}),"normal_activity"===this.formKey.activity_type&&(this.formKey.desc_type&&"text"===this.formKey.desc_type?(this.onText(),this.formKey.description=this.formKey.description&&JSON.parse(this.formKey.description),setTimeout(function(){e.$nextTick(function(){e.$refs.ue1&&e.$refs.ue1[0]&&(e.$refs.ue1[0]._data.editor.body.innerHTML=e.formKey.description.pc?e.formKey.description.pc:""),e.$refs.ue2&&e.$refs.ue2[0]&&(e.$refs.ue2[0]._data.editor.body.innerHTML=e.formKey.description.mobile?e.formKey.description.mobile:"")})},1e3)):"pic"===this.formKey.desc_type&&(this.onImg(),this.formKey.description=JSON.parse(t["description"])));var i=t.id;this.formKey.id=i}},mounted:function(){var t=this;this.$nextTick(function(){if("edit"===t.$route.params.page){var e={id:t.$route.query.id,siteId:t.$route.query.siteId};Object(f["g"])(e).then(function(e){200===e.code&&t.initEdit(e.data)})}}),"create"===this.$route.params.page&&this.formKey.client_type.push("pc")}}),T=C,$=(i("9e61"),Object(b["a"])(T,n,a,!1,null,"a9500ec6",null));e["default"]=$.exports},"3c43":function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!==typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!==typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},"3e8f":function(t,e){},"47e0":function(t,e,i){},5118:function(t,e,i){(function(t){var n="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(a.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new o(a.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i("6017"),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i("c8ba"))},6017:function(t,e,i){(function(t,e){(function(t,i){"use strict";if(!t.setImmediate){var n,a=1,o={},s=!1,r=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?f():p()?y():t.MessageChannel?h():r&&"onreadystatechange"in r.createElement("script")?_():v(),c.setImmediate=l,c.clearImmediate=u}function l(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var s={callback:t,args:e};return o[a]=s,n(a),a++}function u(t){delete o[t]}function m(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(i,n);break}}function d(t){if(s)setTimeout(d,0,t);else{var e=o[t];if(e){s=!0;try{m(e)}finally{u(t),s=!1}}}}function f(){n=function(t){e.nextTick(function(){d(t)})}}function p(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}function y(){var e="setImmediate$"+Math.random()+"$",i=function(i){i.source===t&&"string"===typeof i.data&&0===i.data.indexOf(e)&&d(+i.data.slice(e.length))};t.addEventListener?t.addEventListener("message",i,!1):t.attachEvent("onmessage",i),n=function(i){t.postMessage(e+i,"*")}}function h(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;d(e)},n=function(e){t.port2.postMessage(e)}}function _(){var t=r.documentElement;n=function(e){var i=r.createElement("script");i.onreadystatechange=function(){d(e),i.onreadystatechange=null,t.removeChild(i),i=null},t.appendChild(i)}}function v(){n=function(t){setTimeout(d,0,t)}}})("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(this,i("c8ba"),i("4362"))},"9e61":function(t,e,i){"use strict";var n=i("47e0"),a=i.n(n);a.a},d1e0:function(t,e,i){},db16:function(t,e,i){"use strict";var n=i("d1e0"),a=i.n(n);a.a},e945:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("script",{ref:"editor",attrs:{id:t.id,type:"text/plain"}})])},a=[],o={name:"UE",data:function(){return{editor:null}},props:{defaultMsg:{type:String},config:{type:Object},id:{type:String}},mounted:function(){var t=this;this.editor=window.UE.getEditor(this.id,this.config),this.editor.addListener("ready",function(){t.editor.setContent(t.defaultMsg)})},methods:{getUEContent:function(){return this.editor.getContent()},getUEContentTxt:function(){return this.editor.getContentTxt()}},destroyed:function(){this.editor.destroy()}},s=o,r=i("2877"),c=Object(r["a"])(s,n,a,!1,null,null,null),l=c.exports;e["a"]=l}}]);