(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-657ab544"],{"1acb":function(e,t,n){},"3e8f":function(e,t){},5118:function(e,t,n){(function(e){var a="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,a,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,a,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(a,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("c8ba"))},6017:function(e,t,n){(function(e,t){(function(e,n){"use strict";if(!e.setImmediate){var a,i=1,o={},s=!1,r=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?d():p()?y():e.MessageChannel?h():r&&"onreadystatechange"in r.createElement("script")?b():g(),u.setImmediate=c,u.clearImmediate=l}function c(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var s={callback:e,args:t};return o[i]=s,a(i),i++}function l(e){delete o[e]}function m(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(n,a);break}}function f(e){if(s)setTimeout(f,0,e);else{var t=o[e];if(t){s=!0;try{m(t)}finally{l(e),s=!1}}}}function d(){a=function(e){t.nextTick(function(){f(e)})}}function p(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function y(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&f(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),a=function(n){e.postMessage(t+n,"*")}}function h(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;f(t)},a=function(t){e.port2.postMessage(t)}}function b(){var e=r.documentElement;a=function(t){var n=r.createElement("script");n.onreadystatechange=function(){f(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function g(){a=function(e){setTimeout(f,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n("c8ba"),n("4362"))},"988a":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("Form",{ref:"paymentInfo",attrs:{model:e.paymentInfo,rules:e.rules}},[n("FormItem",{attrs:{label:"支付平台",prop:"queryName"}},[n("Select",{staticClass:"w360",attrs:{placeholder:"请选择,可查询",filterable:""},on:{"on-change":e.changquery},model:{value:e.paymentInfo.queryName,callback:function(t){e.$set(e.paymentInfo,"queryName",t)},expression:"paymentInfo.queryName"}},e._l(e.platformList,function(t,a){return n("Option",{key:a,attrs:{value:t.queryName}},[e._v(e._s(t.payName))])}),1)],1),n("FormItem",{attrs:{label:"商户编号",prop:"businessNo"}},[n("Input",{staticClass:"w360",attrs:{placeholder:"10位数(支持微信支付)"},model:{value:e.paymentInfo.businessNo,callback:function(t){e.$set(e.paymentInfo,"businessNo",t)},expression:"paymentInfo.businessNo"}})],1),e._l(e.paymentInfo.paylist,function(t,a,i){return n("FormItem",{key:t.index,staticStyle:{"margin-left":"10px"},attrs:{label:t.label}},[n("Input",{staticClass:"w360",model:{value:t[Object.keys(t)[2]],callback:function(n){e.$set(t,Object.keys(t)[2],n)},expression:"item[Object.keys(item)[2]]"}})],1)}),n("FormItem",{attrs:{label:"支付方式",prop:"payMethod"}},[n("paymentRadio",{ref:"payment",staticClass:"w360",attrs:{methodsdetail:e.paymentAdd},on:{sendArray:e.getChecked}})],1),n("FormItem",{attrs:{label:"支付域名",prop:"redirect_domain"}},[n("Input",{staticClass:"w360",attrs:{placeholder:"例：123456.com"},model:{value:e.paymentInfo.redirect_domain,callback:function(t){e.$set(e.paymentInfo,"redirect_domain",t)},expression:"paymentInfo.redirect_domain"}})],1),n("FormItem",{attrs:{label:"支付状态",prop:"status"}},[n("Select",{staticClass:"w360",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.paymentInfo.status,callback:function(t){e.$set(e.paymentInfo,"status",t)},expression:"paymentInfo.status"}},[n("Option",{attrs:{value:"yes"}},[e._v("启用")]),n("Option",{attrs:{value:"no"}},[e._v("停用")])],1)],1),n("FormItem",[n("Button",{staticClass:"ivu-btn save",staticStyle:{"margin-left":"76px",width:"360px"},attrs:{loading:e.$root.editBtnLoading},on:{click:e.submit}},[e._v("确认添加")])],1)],2)],1)},i=[],o=n("a4bb"),s=n.n(o),r=(n("c5f6"),n("ac6a"),n("db0c")),u=n.n(r),c=n("f499"),l=n.n(c),m=n("cebc"),f=n("a4d8"),d=n("cd05"),p=n("2f62"),y=(n("3e8f"),n("2934"),n("c276")),h=(n("3022"),n("5118")),b=(n("df7c"),{name:"addPayment",components:{paymentRadio:f["a"]},data:function(){return{uploadForm:{headers:{Authorization:Object(y["j"])()},action:"/api/v2/uploadImg",data:{siteId:""},name:"img",defaultList:[],path:"",src:""},la:1,showID:!1,gongKeyValue:"",siKeyValue:"",payKey:[],paymentAdd:[],paylist:"",platformList:[],newplatdata:"",paymentInfo:{siteId:"",siteName:"",classId:"",payName:"",status:"yes",businessNo:"",redirect_domain:"",queryName:"",businessKey:{},payMethod:"",bankCode:""},rules:{queryName:[{required:!0,message:"请选择支付平台",trigger:"blur"}],businessNo:[{required:!0,message:"请输入平台编号",trigger:"blur"},{required:!0,message:"请输入平台编号",trigger:"blur"}],gongyao:[{required:!0,message:"请输入支付公钥",trigger:"blur"}],payMethod:[{required:!0,message:"请选择支付方式",trigger:"change"}],redirect_domain:[{required:!0,message:"请输入域名",trigger:"blur",pattern:/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/}],status:[{required:!0,message:"请选择支付状态",trigger:"blur"}]}}},created:function(){var e=this;this.getselectlist(),Object(h["setTimeout"])(function(){e.$refs.payment.getpayselectlist()})},methods:{submit:function(){var e=this;this.$root.startEditLoading();var t=Object(m["a"])({},this.paymentInfo,this.newplatdata);t.siteId=this.$root.nowSite.id,t.siteName=this.$root.nowSite.siteName;var n=[];t.newarray&&t.newarray.length>0&&t.newarray.map(function(e){n.push(e.id)}),n.length>1?t.classId=n.join(","):t.classId=n[0],delete t.newarray,t.formatAmount=l()(t.formatAmount),t.limitAmount=l()(t.limitAmount);var a,i=!1,o=!1;if("{}"==t.formatAmount)delete t.formatAmount;else{var r;if(void 0==t.formatAmount)return;r=u()(JSON.parse(t.formatAmount)),r.forEach(function(t){if(""==t.formatAmount||Number(t.maxAmount)<0||Number(t.minAmount)<0)return e.$Tip.info({content:"请输入固定金额"}),i=!0,!1})}"{}"==t.limitAmount?delete t.limitAmount:(a=u()(JSON.parse(t.limitAmount)),a.forEach(function(t){return null==t.maxAmount||null==t.minAmount?(e.$Tip.info({content:"请输入单笔金额"}),o=!0,!1):Number(t.maxAmount)<=Number(t.minAmount)||Number(t.maxAmount)<0||Number(t.minAmount)<0?(e.$Tip.info({content:"单笔上限必须大于单笔下限,而且不能为负数"}),o=!0,!1):void 0}));if(i||o)return!1;t.paylist&&t.paylist.length>0&&t.paylist.map(function(e,n,a){var i=s()(e)[2],o=e[s()(e)[2]];t.businessKey[i]=o}),t.businessKey=l()(t.businessKey),delete t.paylist,this.$refs.paymentInfo.validate(function(n){n&&(delete t.payMethod,Object(d["o"])(t).then(function(n){200==n.code&&e.$Tip.success({content:"添加支付平台成功",onOk:function(){e.$router.push({path:"paymentManager",query:{status:t.status,siteId:t.siteId}})}})}))})},getChecked:function(e){this.newplatdata=e,this.paymentInfo.payMethod="6666",console.log(this.newplatdata.newarray),this.showID=this.newplatdata.newarray.some(function(e){return"网银在线"==e.className})},getselectlist:function(){var e=this;Object(d["y"])({siteId:this.$root.nowSite.id,purpose:"payment_channel"}).then(function(t){e.platformList=t.data})},changquery:function(){var e=this;this.paylist="",this.paylist=this.platformList.filter(function(t){return t.queryName==e.paymentInfo.queryName})[0].needUseKeyType,this.paymentInfo.payName=this.platformList.filter(function(t){return t.queryName==e.paymentInfo.queryName})[0].payName,this.paymentInfo.bankCode=this.platformList.filter(function(t){return t.queryName==e.paymentInfo.queryName})[0].bankCode,this.paylist.map(function(e){if(e.input_name){var t=e.input_name,n="";e[t]=n}}),this.paymentInfo.paylist=this.paylist},onUploadSuccess:function(e,t){var n=e.data,a=n.path,i=(n.src,t),o=a;this.paymentInfo[i]=o}},computed:Object(m["a"])({username:function(){return Object(y["k"])()}},Object(p["d"])({token:function(e){return e.user.token}})),watch:{"$root.nowSite":{handler:function(e){this.uploadForm.data.siteId=e.id},deep:!0}}}),g=b,I=(n("e7ce"),n("2877")),v=Object(I["a"])(g,a,i,!1,null,"2b9d83e4",null);t["default"]=v.exports},e7ce:function(e,t,n){"use strict";var a=n("1acb"),i=n.n(a);i.a}}]);