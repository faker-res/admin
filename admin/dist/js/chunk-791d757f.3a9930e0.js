(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-791d757f"],{"03a7":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"v2-search"},[a("Form",{ref:"searchKey",attrs:{inline:""}},["super"==t.adminType||-1!=t.authInPage.indexOf("lotteryAddNum")?a("Button",{staticClass:"w120x cardNutton",on:{click:function(e){return t.showModal("addLottery")}}},[t._v("添加开奖")]):t._e(),a("FormItem",{attrs:{label:"彩票名称"}},[a("LotterySelect",{ref:"lotterySelect",staticClass:"s-140",attrs:{mode:"官方彩",clearable:!1},on:{"on-lottery-change":t.OnLotteryChange,"on-name-change":t.onNameChange}})],1),a("FormItem",{attrs:{label:"期数"}},[a("Input",{staticClass:"s-140",attrs:{clearable:"",placeholder:"请输入期数"},model:{value:t.searchKey.issue,callback:function(e){t.$set(t.searchKey,"issue",e)},expression:"searchKey.issue"}})],1),a("FormItem",{attrs:{label:"状态"}},[a("Select",{staticClass:"s-140",model:{value:t.searchKey.status,callback:function(e){t.$set(t.searchKey,"status",e)},expression:"searchKey.status"}},[a("Option",{attrs:{value:"0"}},[t._v("全部")]),a("Option",{attrs:{value:"1"}},[t._v("已结算")]),a("Option",{attrs:{value:"2"}},[t._v("未结算")])],1)],1),a("FormItem",[a("Button",{staticClass:"search",attrs:{type:"primary",loading:t.$root.searchBtnLoading},on:{click:function(e){return t.searchSubmit("search")}}},[t._v("查询")])],1)],1)],1),a("div",{staticClass:"v2-table"},[a("Tables",{ref:"tables",attrs:{columns:t.table.columns,loading:t.$root.tableLoading,value:t.table.data,total:t.table.total,pageSizeOpts:t.table.pageSizeOpts},on:{"on-page-change":t.onPageChange,"on-page-size-change":t.onPageSizeChange}})],1),a("Modals",{ref:"lotteryBack",attrs:{title:"开奖回滚",width:"800"}},[a("div",{staticClass:"ft14 ml0",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"mb20 ml20 mt20"},[t._v("彩票名称: "+t._s(t.lotteryName))]),a("Form",{ref:"lotteryBackInfo",attrs:{model:t.lotteryBackInfo,rules:t.lotteryBackInfoValidate,"label-width":110,inline:""}},[a("div",{staticClass:"ml105f"},[a("FormItem",[a("span",{staticClass:"pl15 pr15"},[t._v(t._s(t.lotteryBackInfo.issue)+"期")]),a("span",{staticClass:"pr15"},[t._v("撤回类型")]),a("Select",{staticStyle:{width:"140px"},model:{value:t.lotteryBackInfo.type,callback:function(e){t.$set(t.lotteryBackInfo,"type",e)},expression:"lotteryBackInfo.type"}},[a("Option",{attrs:{value:"1"}},[t._v("撤回未中奖注单")]),a("Option",{attrs:{value:"2"}},[t._v("撤回所有注单")])],1)],1),a("FormItem",{attrs:{label:"开奖号码",prop:"lotteryNum"}},[a("Input",{staticClass:"w240x",attrs:{placeholder:"如：1,2,3,4,5,6,7(以英文逗号隔开)"},model:{value:t.lotteryBackInfo.lotteryNum,callback:function(e){t.$set(t.lotteryBackInfo,"lotteryNum",e)},expression:"lotteryBackInfo.lotteryNum"}})],1)],1),a("Button",{staticClass:"btw260 ft20 mb20",staticStyle:{"margin-left":"250px"},attrs:{type:"primary"},on:{click:function(e){return t.searchSubmit("back")}}},[t._v("确认回滚")])],1)],1)]),a("Modals",{ref:"addLottery",attrs:{title:"添加开奖",width:"560"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("Form",{ref:"addLotteryInfo",staticStyle:{width:"560px"},attrs:{model:t.addLotteryInfo,rules:t.addLotteryInfoValidate,"label-width":160}},[a("FormItem",{staticClass:"mt20",attrs:{label:"期数",prop:"issue"}},[a("Input",{staticClass:"w240x",attrs:{placeholder:"如2019001"},model:{value:t.addLotteryInfo.issue,callback:function(e){t.$set(t.addLotteryInfo,"issue",e)},expression:"addLotteryInfo.issue"}})],1),a("FormItem",{attrs:{label:"封盘时间",prop:"openingTime"}},[a("DatePicker",{staticStyle:{width:"240px"},attrs:{transfer:"",type:"datetime",placeholder:"请选择封盘时间"},model:{value:t.addLotteryInfo.openingTime,callback:function(e){t.$set(t.addLotteryInfo,"openingTime",e)},expression:"addLotteryInfo.openingTime"}})],1),a("FormItem",{attrs:{label:"开奖号码",prop:"number"}},[a("Input",{staticClass:"w240x",attrs:{placeholder:"如：1,2,3,4,5,6,7(以英文逗号隔开)"},model:{value:t.addLotteryInfo.number,callback:function(e){t.$set(t.addLotteryInfo,"number",e)},expression:"addLotteryInfo.number"}})],1),a("FormItem",[a("Button",{staticClass:"w240x",attrs:{type:"primary"},on:{click:function(e){return t.searchSubmit("add")}}},[t._v("确认添加")])],1)],1)],1)]),a("Modals",{ref:"editLotteryNum",attrs:{title:"修改开奖号码",width:"680"}},[a("div",{staticClass:"v2-form-wrapper",attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"lotteryMan"},[a("Form",{staticStyle:{width:"680px"}},[a("FormItem",[a("div",{staticClass:"ml80"},[a("span",[t._v("彩票名称："+t._s(t.lotteryName))]),a("span")])]),a("div",{staticClass:"ml80 ft14"},[a("p",{staticClass:"mb15"},[t._v(t._s(t.editInfo.issue)+"期")]),a("FormItem",{staticClass:"periods"},[a("div",{staticClass:"clearfix ml20"},t._l(t.editInfo.number,function(e,s){return a("p",{key:s,staticClass:"fl"},[a("Input",{staticClass:"ib",model:{value:t.editInfo.number[s],callback:function(e){t.$set(t.editInfo.number,s,e)},expression:"editInfo.number[i]"}}),a("span",{staticClass:"p10 yc"},[t._v("-")])],1)}),0)])],1),a("FormItem",[a("Button",{staticClass:"w240x ml220",attrs:{type:"primary"},on:{click:function(e){return t.searchSubmit("edit")}}},[t._v("确认保存")])],1)],1)],1)])])],1)},r=[],n=(a("ac6a"),a("7f7f"),a("e814")),o=a.n(n),i=(a("6762"),a("2fdb"),a("28a5"),a("cebc")),l=a("fa69"),c=a("d027"),d=a("2f62"),u=a("3445"),f=a("1184"),m=a("c276"),y={name:"lotteryManagement",components:{Tables:l["a"],Modals:c["a"],LotterySelect:u["a"]},computed:Object(i["a"])({},Object(d["d"])({sixLotteryColor:function(t){return t.info.sixLotteryColor}})),data:function(){var t=this,e=this.$createElement;return{adminType:Object(m["l"])(),authInPage:JSON.parse(localStorage.authInPage),currentIndex:0,lotteryName:"香港六合彩",selectLotteryList:[],searchKey:{lid:1,issue:"",status:"0"},addLotteryInfo:{issue:"",openingTime:"",number:""},editInfo:{},addLotteryInfoValidate:{issue:[{required:!0,message:"请输入期数",trigger:"blur"},{message:"请输入合法期数",trigger:"blur",pattern:/^[+]{0,1}(\d+)$/}],openingTime:[{required:!0,message:"请选择封盘时间",trigger:"blur",pattern:/.+/}],number:[{required:!0,message:"请输入开奖号码",trigger:"blur"}]},lotteryBackInfo:{lotteryNum:""},lotteryBackInfoValidate:{lotteryNum:[{required:!0,message:"请输入开奖号码",trigger:"blur"}]},table:{total:0,title:"开奖管理",pageSizeOpts:[20,30,40],data:[],columns:[{title:"期数",key:"issue",align:"center"},{title:"开奖结果",key:"resultInfo",align:"center",width:320,render:function(e,a){var s,r=a.row,n=r.lotteryId,i=r.resultInfo;return i.split(",").map(function(a){if(1==n||18==n||19==n)t.sixLotteryColor.map(function(t){t.number.includes(1*a)&&(s=t.color)});else{var r=o()(256*Math.random()),i=o()(256*Math.random()),l=o()(256*Math.random());s="rgba(".concat(r,",").concat(i,",").concat(l,",.9)")}return e("span",{style:{color:"#fff",cursor:"pointer",width:"20px",height:"20px",marginLeft:"5px",display:"inline-block",backgroundColor:s,textShadow:"1px 1px 1px #000"}},a)})}},{title:"开奖时间",key:"openingTime",align:"center",render:function(e,a){return e("span",[t.$root.unixTime(a.row.openingTime)])}},{title:"添加时间",key:"addTime",align:"center",render:function(e,a){return e("span",[t.$root.unixTime(a.row.addTime)])}},{title:"状态",key:"status",align:"center",render:function(t,e){return t("span",["no"===e.row.status?"未结算":"已结算"])}},{title:"操作",align:"center",render:function(a,s){return e("div",[e("a",{style:{display:"no"!==s.row.status||"super"!=t.adminType&&-1==t.authInPage.indexOf("lotteryUpNum")?"none":"inline-block",paddingRight:"15px"},on:{click:function(){var e=s.row,a=e.issue,r=e.resultInfo;t.$refs.editLotteryNum.show(),t.editInfo={issue:a,lid:t.searchKey.lid,number:r.split(",")},t.currentIndex=s.index}}},"修改"),e("a",{style:{display:"yes"!=s.row.status||"super"!=t.adminType&&-1==t.authInPage.indexOf("lotteryAgainPrize")?"none":"inline-block",paddingRight:"15px"},on:{click:function(){var e=s.row,a=e.issue;e.resultInfo;t.lotteryBackInfo={type:"1",issue:a},t.$refs.lotteryBackInfo.resetFields(),t.$refs.lotteryBack.show()}}},"回滚"),e("a",{style:{display:"super"==t.adminType||-1!=t.authInPage.indexOf("lotteryPayMoney")?"inline-block":"none"},on:{click:function(){var e={issue:s.row.issue,lid:t.searchKey.lid,siteId:t.$root.nowSite.id};Object(f["E"])(e).then(function(e){200==e.data&&t.getData({params:t.searchKey})})}}},"结算")])}}]}}},mounted:function(){var t=this;this.$nextTick(function(){t.$refs.lotterySelect.init(),t.getData({params:t.searchKey})})},methods:{resetForm:function(){for(var t in this.addLotteryInfo)delete this.addLotteryInfo[t]},getData:function(t){var e=this;this.$root.startTableLoading(this),Object(f["C"])(t).then(function(t){var a=t.data,s=a.data,r=a.total;e.table.total=r,e.table.data=s})},showModal:function(t){this.$refs.addLotteryInfo.resetFields(),this.resetForm(),this.$refs[t].show()},OnLotteryChange:function(t){this.searchKey.lid=t},onNameChange:function(t){this.selectLotteryList=t},onPageChange:function(t){Object(i["a"])({},this.searchKey);this.getData({params:this.searchKey,query:{page:t}})},onPageSizeChange:function(t){this.searchKey.limit=t,this.getData({params:this.searchKey})},searchSubmit:function(t){var e=this;switch(t){case"search":this.selectLotteryList.forEach(function(t){t.id==e.searchKey.lid&&(e.lotteryName=t.name)}),this.getData({params:this.searchKey}),this.$refs.tables.setPage();break;case"add":this.$refs.addLotteryInfo.validate(function(t){if(t){e.$refs.addLottery.spinShow();var a=Object(i["a"])({},e.addLotteryInfo,{lid:e.searchKey.lid});a.openingTime=e.$root.formatTimeS(a.openingTime),Object(f["p"])(a).then(function(t){200==t.code&&(e.$refs.addLottery.spinHide(),e.$refs.addLottery.hide(),e.getData({params:e.searchKey}),e.$refs.addLotteryInfo.resetFields())}).catch(function(t){e.$refs.addLottery.spinHide()})}});break;case"edit":var a=this.editInfo,s=a.number,r=a.issue,n={issue:String(r),number:s.join(","),lid:this.searchKey.lid};this.$refs.editLotteryNum.spinShow(),Object(f["J"])(n).then(function(t){e.$refs.editLotteryNum.spinHide(),200==t.code&&(e.$refs.editLotteryNum.hide(),e.table.data[e.currentIndex].resultInfo=n.number)}).catch(function(t){e.$refs.editLotteryNum.spinHide()});break;case"back":this.$refs.lotteryBackInfo.validate(function(t){var a=e.lotteryBackInfo,s=a.type,r=a.issue,n=a.lotteryNum;if(t){e.$refs.lotteryBack.spinShow();var o={lid:e.searchKey.lid,type:s,issue:String(r),result:n};Object(f["r"])(o).then(function(t){e.$refs.lotteryBack.spinHide(),200==t.code&&(e.$refs.lotteryBack.hide(),e.getData({params:e.searchKey}))}).catch(function(t){e.$refs.lotteryBack.spinHide()})}});break}}}},p=y,h=(a("7841"),a("2877")),b=Object(h["a"])(p,s,r,!1,null,"27698c02",null);e["default"]=b.exports},7841:function(t,e,a){"use strict";var s=a("9ccf"),r=a.n(s);r.a},"9ccf":function(t,e,a){}}]);